<section class="mt-5 mb-5" *ngIf="pergunta | async as _pergunta">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
        <a class="btn btn-secondary btn-block" [routerLink]="['/atividades']">
          <i class="fa fa-angle-left" aria-hidden="true"></i>
        </a>
      </div>
      <div class="col-md-11">
        <h1>{{ _pergunta.titulo }}</h1>
      </div>
    </div>
  </div>
</section>
<section class="mb-5">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div *ngIf="conversas$ | async; let conversas; else loading">
          <div class="card mt-3 box-sh-1" *ngFor="let conversa of conversas">
            <div class="card-body" *ngIf="conversa.data.mensagens | async; let mensagens">
              <div class="row" *ngIf="conversa.data.user | async as user">
                <div class="col-md-1">
                  <a [routerLink]="['/users', user.uid]">
                    <img [src]="user.photoURL" class="rounded img-fluid" [alt]="user.nome || user.displayName" [title]="user.nome || user.displayName">
                  </a>
                </div>
                <div class="col-md-11">
                  <div class="row">
                    <div class="col-md-9">
                      <h5>{{ user.nome || user.displayName }}</h5>
                    </div>
                    <div class="col-md-3">
                      <h3 *ngIf="ultimaProposta(mensagens); let proposta" class="text-success">{{ proposta.dataMensagens.valor | currency:'BRL':'symbol' }}</h3>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-11 offset-md-1">
                  <p>{{ mensagens[mensagens.length - 1].dataMensagens.body }}</p>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-md-11 offset-md-1">
                  <a *ngIf="ultimaProposta(mensagens); let proposta" class="btn btn-success" [routerLink]="['/propostas', 'aceitar', proposta.idMensagens]">Aceitar Proposta</a>
                  <a class="btn btn-link text-muted" [routerLink]="['/conversas', conversa.id]">Ir Para As Mensagens</a>
                </div>
              </div>
            </div>
          </div>
          <div class="card card-body text-muted text-center" *ngIf="!conversas.length">
            <h1>Sem Resultados</h1>
            <i class="fa fa-3x fa-frown-o" aria-hidden="true"></i>
          </div>
        </div>
        <ng-template #loading>
          <div class="text-center">
            <i class="fa fa-circle-o-notch text-muted fa-spin fa-3x fa-fw"></i>
            <span class="sr-only">Carregando...</span>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</section>
